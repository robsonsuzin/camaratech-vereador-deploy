import{_ as h,r as i,f as p,aj as S,ar as k,R as u,S as m,U as t,Y as n,V as o,X as g,a1 as c,a4 as f,ab as y,Z as _,ag as v,W as w}from"./index.3a2dc7e9.js";import{Q as b}from"./QBanner.bfa9612d.js";import{Q as V}from"./QPage.1ebc80bd.js";import{u as B}from"./socket.4c51b82e.js";const T={class:"container"},I={class:"text-h5 text-primary"},Q={class:"text-h6"},D={class:"text-caption text-grey-7 q-mt-sm"},R={class:"connection-status"},E={class:"q-ml-sm"},q={__name:"TestSocket",setup(L){const a=B(),r=i(null),l=i(null),x=p(()=>r.value?"bg-purple-2 text-purple-9":""),C=p(()=>"purple"),d=i(1);return window.addEventListener("unitChanged",s=>{const{unitId:e}=s.detail;d.value=e,console.log("[TestSocket Vereador] \u{1F504} Unidade alterada para:",e)}),S(()=>{const s=`unit.${d.value}.test.vereador`;a.subscribeToChannel(s),a.onChannel(s,"test.message.broadcast",e=>{console.log("[Vereador] Evento recebido no canal:",s,"Data:",e),e.message_vereador&&(r.value=e.message_vereador,l.value=new Date().toLocaleString("pt-BR"),console.log("\u2705 Mensagem recebida no tablet:",e.message_vereador))}),a.onChannel(s,"test-message-broadcast",e=>{console.log("[Vereador] Evento kebab-case recebido:",e),e.message_vereador&&(r.value=e.message_vereador,l.value=new Date().toLocaleString("pt-BR"))}),a.on("test.message.broadcast",e=>{console.log("[Vereador] Evento global recebido:",e),e.message_vereador&&(r.value=e.message_vereador,l.value=new Date().toLocaleString("pt-BR"))})}),k(()=>{const s=`unit.${d.value}.test.vereador`;a.unsubscribeFromChannel(s),a.offChannel(s,"test.message.broadcast"),a.offChannel(s,"test-message-broadcast"),a.off("test.message.broadcast")}),(s,e)=>(u(),m(V,{class:"test-socket-page"},{default:t(()=>[n("div",T,[o(w,{class:"message-card"},{default:t(()=>[o(g,null,{default:t(()=>[n("div",I,[o(c,{name:"tablet",class:"q-mr-sm"}),e[0]||(e[0]=f(" Tablet Vereador - Teste de Socket.IO ",-1))]),e[1]||(e[1]=n("div",{class:"text-caption text-grey-7 q-mt-xs"}," Esta p\xE1gina recebe mensagens em tempo real do controle ",-1))]),_:1}),o(g,null,{default:t(()=>[r.value?(u(),m(b,{key:0,rounded:"",class:y(x.value)},{avatar:t(()=>[o(c,{name:"message",color:C.value,size:"32px"},null,8,["color"])]),default:t(()=>[n("div",Q,_(r.value),1),n("div",D," Recebido em: "+_(l.value),1)]),_:1},8,["class"])):(u(),m(b,{key:1,rounded:"",class:"bg-grey-3 text-grey-7"},{avatar:t(()=>[o(c,{name:"hourglass_empty",color:"grey"})]),default:t(()=>[e[2]||(e[2]=f(" Aguardando mensagem do controle... ",-1))]),_:1}))]),_:1}),o(g,null,{default:t(()=>[n("div",R,[o(c,{name:v(a).isConnected?"wifi":"wifi_off",color:v(a).isConnected?"green":"red",size:"24px"},null,8,["name","color"]),n("span",E,_(v(a).isConnected?"Conectado":"Desconectado"),1)])]),_:1})]),_:1})])]),_:1}))}};var $=h(q,[["__scopeId","data-v-2e72c8b0"]]);export{$ as default};
